import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

coefs = [
    0,
    1,
    3/2,
    1/3,
    1/4,
    -2/15,
    1/4,
    -2/35,
    -1/8,
    19/63,
    -3/40,
    -35/99,
    8/15,
    -2/143,
    -13/21,
    34/65,
    25/112,
    -46/85,
    11/48,
    -2/323,
    -1/15,
    188/399,
    -51/110,
    -232/483,
    19/22,
    113/575,
    -23/26,
    163/675,
    5/13,
    -350/783,
    2/5,
    -2/899,
    -69/160,
    144/341,
    -207/544,
    -32/385,
    575/612,
    -446/1295,
    -649/684,
    590/1443,
    51/76,
    -658/1599,
    1/28,
    -2/1763,
    -29/77,
    458/645,
    -87/253,
    -502/705,
    281/276,
    327/2303,
    -217/300,
    207/833,
    8/325,
    -354/901,
    79/234,
    846/2915,
    -5/63,
    296/3135,
    -120/203,
    -1300/3363,
    181/145,
    -2/3599,
    -194/155,
    2438/3843,
    865/1984,
    -1468/4095,
    139/704,
    -1208/4355,
    -123/374,
    580/1541,
    243/1190,
    -616/1633,
    547/840,
    -2/5183,
    -1037/888,
    3502/5475,
    212/703,
    -2348/5775,
    77/247,
    -1424/6083,
    89/520,
    3079/6399,
    -1293/1640,
    -3239/6723,
    139/123,
    1824/7055,
    -146/129,
    268/2465,
    483/946,
    -950/2581,
    61/110,
    254/1157,
    -89/115,
    176/1209,
    -318/1081,
    -200/1767,
    411/376,
    -466/1843,
    -345/392,
    1810/3201,
    2083/4900,
    -1886/3333,
    -89/1700,
    -2/10403,
    -87/884,
    2952/3605,
    -1353/2756,
    -3068/3745,
    1523/1431,
    -2/11663,
    -934/1485,
    4358/12099,
    193/770,
    -4522/12543,
    -29/266,
    3162/12995,
    -325/1102,
    314/1035,
    -975/3422,
    -370/1071,
    87/59,
    -1597/14399,
    -90/61,
    1323/4961,
    533/1891,
    -604/5125,
    436/651,
    -3812/15875,
    -1301/2688
]

data = pd.read_csv("../results/euler_q_n32.csv", encoding="utf-8")

qs, expecteds = data["x"], data["v:=lny*(1-x^2)"]

plt.figure(figsize=(8, 6))

plt.plot(qs, expecteds, label=f"expected", color="black", linewidth = 2, alpha=0.75)

for n in [4, 8, 16, 32, 64, 128]:
    poly = np.polynomial.polynomial.Polynomial(coefs[:n + 1])    
    vs = -poly(qs)
    
    plt.plot(qs, vs, label=f"polynomial degree={n}", zorder=-1, linewidth = 1)
    

plt.xlim([-1, 1])
plt.ylim([-3.5, 0.5])

plt.xlabel(r"$q$")
plt.ylabel(r"$\log ((q; q)_\infty ) \cdot (1-q^2)$")

plt.grid()
plt.legend()

plt.savefig("../figures/euler_q_series_approxpoly.svg")